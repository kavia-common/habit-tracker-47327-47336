{"is_source_file": true, "format": "TypeScript", "description": "An Angular service class HabitService managing habits and their completion states with persistence via local storage and observables.", "external_files": ["../models/habit.model", "../utils/storage.util"], "external_methods": ["StorageUtil.getJSON", "StorageUtil.setJSON", "uuidv4"], "published": ["HabitService"], "classes": [{"name": "HabitService", "description": "Service class that manages habits, completions, and computes statistics related to habits."}], "methods": [{"name": "getHabits$", "description": "Returns an observable stream of the current list of habits."}, {"name": "getCompletions$(): Observable<HabitCompletion[]> { getCompletions$", "description": "Returns an observable stream of all habit completions.", "scope": "HabitService", "scopeKind": "class"}, {"name": "addHabit(input: { name: string; description?: string; dailyGoal?: number }): void { addHabit", "description": "Adds a new habit with specified details to the habits list and persists it.", "scope": "HabitService", "scopeKind": "class"}, {"name": "toggleToday(habitId: string, date: string = todayKey()): void { toggleToday", "description": "Toggles today's completion count for a specific habit, resetting or incrementing based on current count.", "scope": "HabitService", "scopeKind": "class"}, {"name": "getHabitsWithStats$(): Observable<HabitWithStats[]> { getHabitsWithStats$", "description": "Provides an observable of habits enriched with today's count, streaks, and weekly data.", "scope": "HabitService", "scopeKind": "class"}, {"name": "getProgressSummary$(): Observable<{ getProgressSummary$", "description": "Calculates overall progress summary including total habits, today's completed habits, and weekly data.", "scope": "HabitService", "scopeKind": "class"}, {"name": "StorageUtil.getJSON<Habit[]>(HabitService.HABITS_KEY, []) StorageUtil", "scope": "HabitService", "scopeKind": "class", "description": "unavailable"}], "calls": ["StorageUtil.getJSON", "StorageUtil.setJSON", "uuidv4", "combineLatest", "map"], "search-terms": ["HabitService", "habits", "completions", "local storage", "habit management", "habit streaks", "habit stats", "Angular", "BehaviorSubject"], "state": 2, "file_id": 24, "knowledge_revision": 80, "git_revision": "", "revision_history": [{"51": ""}, {"80": ""}], "ctags": [{"_type": "tag", "name": "COMPLETIONS_KEY", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^  private static COMPLETIONS_KEY = 'habits:completions:v1';$/", "language": "TypeScript", "kind": "property", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "HABITS_KEY", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^  private static HABITS_KEY = 'habits:data:v1';$/", "language": "TypeScript", "kind": "property", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "HabitService", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^export class HabitService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "StorageUtil", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    StorageUtil.getJSON<Habit[]>(HabitService.HABITS_KEY, [])$/", "language": "TypeScript", "kind": "method", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "addHabit", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^  addHabit(input: { name: string; description?: string; dailyGoal?: number }): void {$/", "language": "TypeScript", "kind": "method", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "c", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^            const c = comps.find(cc => cc.habitId === h.id && cc.date === key)?.count ?? 0;$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getHabitsWithStats$", "scopeKind": "method"}, {"_type": "tag", "name": "completedToday", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^        const completedToday = habits.filter(h => {$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getProgressSummary$", "scopeKind": "method"}, {"_type": "tag", "name": "comps", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    const comps = [...this.completions$.value];$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.toggleToday", "scopeKind": "method"}, {"_type": "tag", "name": "current", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^      const current = comps[idx];$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.toggleToday", "scopeKind": "method"}, {"_type": "tag", "name": "d", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^            const d = new Date();$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getHabitsWithStats$", "scopeKind": "method"}, {"_type": "tag", "name": "dailyGoal", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    const dailyGoal = Math.max(1, input.dailyGoal ?? 1);$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.addHabit", "scopeKind": "method"}, {"_type": "tag", "name": "getCompletions$", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^  getCompletions$(): Observable<HabitCompletion[]> {$/", "language": "TypeScript", "kind": "method", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "getHabitsWithStats$", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^  getHabitsWithStats$(): Observable<HabitWithStats[]> {$/", "language": "TypeScript", "kind": "method", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "getProgressSummary$", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^  getProgressSummary$(): Observable<{$/", "language": "TypeScript", "kind": "method", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "goal", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    const goal = habit?.dailyGoal ?? 1;$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.toggleToday", "scopeKind": "method"}, {"_type": "tag", "name": "habit", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    const habit = this.habits$.value.find(h => h.id === habitId);$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.toggleToday", "scopeKind": "method"}, {"_type": "tag", "name": "habits$", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^  private habits$ = new BehaviorSubject<Habit[]>($/", "language": "TypeScript", "kind": "property", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^      const current = comps[idx];$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.toggleToday", "scopeKind": "method"}, {"_type": "tag", "name": "idx", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    const idx = comps.findIndex(c => c.habitId === habitId && c.date === date);$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.toggleToday", "scopeKind": "method"}, {"_type": "tag", "name": "key", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^            const key = todayKey(d);$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getHabitsWithStats$", "scopeKind": "method"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    const list = [...this.habits$.value, newHabit];$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.addHabit", "scopeKind": "method"}, {"_type": "tag", "name": "newHabit", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    const list = [...this.habits$.value, newHabit];$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.addHabit", "scopeKind": "method"}, {"_type": "tag", "name": "newHabit", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^    const newHabit: Habit = {$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.addHabit", "scopeKind": "method"}, {"_type": "tag", "name": "nextCount", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^      const nextCount = current.count >= goal ? 0 : current.count + 1;$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.toggleToday", "scopeKind": "method"}, {"_type": "tag", "name": "today", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^        const today = todayKey();$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getHabitsWithStats$", "scopeKind": "method"}, {"_type": "tag", "name": "today", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^        const today = todayKey();$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getProgressSummary$", "scopeKind": "method"}, {"_type": "tag", "name": "todayCount", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^          const todayCount = comps.find(c => c.habitId === h.id && c.date === today)?.count ?? 0/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getHabitsWithStats$", "scopeKind": "method"}, {"_type": "tag", "name": "toggleToday", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^  toggleToday(habitId: string, date: string = todayKey()): void {$/", "language": "TypeScript", "kind": "method", "scope": "HabitService", "scopeKind": "class"}, {"_type": "tag", "name": "week", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^        const week = lastNDates(7);$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getHabitsWithStats$", "scopeKind": "method"}, {"_type": "tag", "name": "week", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^        const week = lastNDates(7);$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getProgressSummary$", "scopeKind": "method"}, {"_type": "tag", "name": "weekData", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^        const weekData = week.map(d => {$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getProgressSummary$", "scopeKind": "method"}, {"_type": "tag", "name": "weekly", "path": "/home/kavia/workspace/code-generation/habit-tracker-47327-47336/habit_tracker_frontend/src/app/services/habit.service.ts", "pattern": "/^          const weekly = week.map((d) => ({$/", "language": "TypeScript", "kind": "constant", "scope": "HabitService.getHabitsWithStats$", "scopeKind": "method"}], "hash": "b8ee78459e771dd8bf73b4a11c5f905d", "format-version": 4, "code-base-name": "habit_tracker_frontend", "filename": "habit_tracker_frontend/src/app/services/habit.service.ts", "fields": [{"name": "private static COMPLETIONS_KEY = 'habits:completions:v1';", "scope": "HabitService", "scopeKind": "class", "description": "unavailable"}, {"name": "private static HABITS_KEY = 'habits:data:v1';", "scope": "HabitService", "scopeKind": "class", "description": "unavailable"}, {"name": "private habits$ = new BehaviorSubject<Habit[]>(", "scope": "HabitService", "scopeKind": "class", "description": "unavailable"}]}